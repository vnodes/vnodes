/// @GeneratedFields([id, createdAt, updatedAt, deletedAt])
generator client {
  provider = "prisma-client"
  output   = "../src/lib/client"
}

datasource db {
  provider = "postgresql"
}

enum ContactType {
  Personal
  Company
  Other
}

enum Gender {
  Male
  Female
}

model Address {
  id        Int       @id @default(autoincrement())
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  lable   String? /// @description("Explanation for the addresss")
  street  String /// 
  city    String /// @min(3) @max(255)
  state   String /// @min(3) @max(255)
  country String /// @min(3) @max(255)
  zip     String /// @min(3) @max(30)
  notes   String? /// @description("Address description")

  contactType ContactType @default(Other) /// @readonly()
  contactId   Int /// @readonly()
  contact     Contact     @relation(fields: [contactId], references: [id])

  @@unique([country, state, city, street, contactId])
  @@index([zip])
  @@index([country])
  @@index([state])
  @@index([city])
  @@index([street])
}

model Email {
  id        Int       @id @default(autoincrement())
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  label       String?
  value       String
  notes       String?
  contactType ContactType @default(Other) /// @readonly()
  contact     Contact     @relation(fields: [contactId], references: [id])
  contactId   Int /// @readonly()

  @@unique([value, contactId])
}

model Phone {
  id        Int       @id @default(autoincrement())
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  label       String?
  value       String
  notes       String?
  contactType ContactType @default(Other) /// @readonly()
  contact     Contact     @relation(fields: [contactId], references: [id])
  contactId   Int /// @readonly()

  @@unique([value, contactId])
}

model Contact {
  id        Int       @id @default(autoincrement())
  uuid      String    @unique @db.Uuid /// @readonly()
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  firstName  String
  lastName   String
  middleName String?

  gender Gender?

  company String?

  occupation String?

  /// @projection()
  addresses Address[]

  /// @projection()
  emails Email[]

  /// @projection()
  phones Phone[]
}
